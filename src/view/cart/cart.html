<!doctype html>
<html lang="en">
<head>
    <%= require('../common/head.htm') %>

</head>
<body>
    <%= require('../common/header.htm') %>

<div id="BackLink">
    <a href="/catalog/main">Return to Main Menu</a>
</div>
<!-- <font color="red" th:if="${msg}!=null" th:text="${msg}"></font> -->


<div id="Catalog">

    <div id="Cart">
        <h2>Shopping Cart</h2>
        <form action="#" method="post">
            <table id="carttable" >
                <tr>
                    <th><b>Item ID</b></th>
                    <th><b>Product ID</b></th>
                    <th><b>Description</b></th>
                    <th><b>In Stock?</b></th>
                    <th><b>Quantity</b></th>
                    <th><b>List Price</b></th>
                    <th><b>Total Cost</b></th>
                    <th><b>&nbsp;</b></th>
                </tr>
                <tr v-if="cartIsEmpty">
                    <td colspan="8"><b>Your cart is empty.</b></td>
                </tr>


                <tr th:each="cartItem:${cart}" th:id="${cartItem.item.itemId}" v-if="cartIsNotEmpty" v-for="cartItem in cart">
                    <td>
                        <a th:text="${cartItem.item.itemId}"
                           th:href="@{/catalog/viewItem(itemId=${cartItem.item.itemId},
                                                productId=${cartItem.item.product.productId},name=${cartItem.item.product.name},categoryId=${cartItem.item.product.categoryId},description=${cartItem.item.product.description})}">
                            {{ cartItem.item.itemId }}
                        </a>
                    </td>
                    <td th:text=" ${cartItem.item.product.productId}">
                        {{ cartItem.item.productId }}
                    </td>
                    <td>
                        <span th:if="${cartItem.item.attribute1!=null}"
                              th:text="${cartItem.item.attribute1}">
                                {{ cartItem.item.attribute1 }}
                        </span>
                                <span th:if="${cartItem.item.attribute2!=null}"
                                      th:text="${cartItem.item.attribute2}">
                                {{ cartItem.item.attribute2 }}
                        </span>
                                <span th:if="${cartItem.item.attribute3!=null}"
                                      th:text="${cartItem.item.attribute3}">
                                {{ cartItem.item.attribute3 }}
                        </span>
                                <span th:if="${cartItem.item.attribute4!=null}"
                                      th:text="${cartItem.item.attribute4}">
                                {{ cartItem.item.attribute4 }}
                        </span>
                                <span th:if="${cartItem.item.attribute5!=null}"
                                      th:text="${cartItem.item.attribute5}">
                                {{ cartItem.item.attribute5 }}
                        </span>
                    </td>
                    <td th:text="${cartItem.inStock}+'&qty: '+${qtyListIterator.next()}">
                        {{ cartItem.inStock }}
                    </td>
                    <td>
                        <input type="text" :name=cartItem.item.itemId :value=cartItem.quantity @blur="updateCartItem"/>
                    </td>
                    <td :formatter="value => `${value} S`" :parser="value => value.replace(' S', '')">
                        <!-- <fmt:formatNumber th:text="${cartItem.item.listPrice}" pattern="$#,##0.00"/> -->
                        {{ cartItem.item.listPrice }}
                    </td>
                    <td :formatter="value => `${value} S`" :parser="value => value.replace(' S', '')">
                        <div :id="'itemtotalcost'+cartItem.item.itemId">
                            <!-- <fmt:formatNumber th:text="${cartItem.total}" pattern="$#,##0.00" /> -->
                            {{ cartItem.total }}
                        </div>
                    </td>
                    <td>
                        <a :href="'/cart/removeItemFromCart?itemId='+cartItem.item.itemId" class="Button">Remove</a>
                    </td>
                </tr>
            </table>
<!--            <table>-->
<!--                <tr>-->
<!--                    <td colspan="7">-->
<!--                        <input type="submit" value="Update Cart">-->
<!--                    </td>-->
<!--                </tr>-->
<!--            </table>-->
        </form>

        <p v-if="cartIsNotEmpty">
            <a href="../../view/order/view-order.html" class="Button">Proceed to Checkout</a>
        </p>
    </div>

    <div id="Separator">&nbsp;</div>
</div>

<%= require('../common/footer.htm') %>
    
</body>
</html>